# C语言
C程序设计语言最早是由Dennis Ritchie于1973年设计并实现的。从那时开始，C语言从其位于贝尔实验室的发源地传播到世界各地。1988年，美国国家标准协会(ANSI)为C语言指定了一个精确的标准，该标准保持了C的**表达能力、效率、小规模以及对机器的最终控制**，同时还保证符合标准的程序可以从一种计算机与操作系统移植到另一种计算机与操作系统而无需改变。这个标准同时也被国际标准化组织(ISO)接受为国际标准，是世界各地的用户都受益于这一标准。
```C
#include <stdio.h>      // 包含标准库的信息
main()      // 定义名为main的函数，它不接受参数值
{
    printf("Hello, world\n");       // main函数调用库函数printf以显示字符序列；
}                                                                 //   \n代表换行符
```
在本例中，函数的名字为main。通常情况下，函数的命名没有限制，但main是一个特殊的函数名——**每个**程序都从**main函数**的起点开始执行，这意味着每个程序都必须在某个位置包含一个main函数。
main函数通常会调用其他函数来帮助完成某些工作，被调用的函数可以是程序设计人员自己编写的，也可以来自于函数库。上述程序段中的第一行语句
```C
#include <studio.h>
```
用于告诉编译器在本程序中包含标准输入/输出库的信息。
函数之间进行数据交换的一种方法是调用函数向被调用函数提供一个值(称为**参数**)列表。函数名后面的一对圆括号将参数列表括起来。在本例中，main函数不需要任何参数，因此空参数表()表示。函数中的语句用于一对花括号{}括起来。
调用函数时，只需要使用函数名加上用圆括号括起来的参数表即可。
C语言中，字符序列\n表示**换行符**，在打印中遇到它时，输出打印将换行，从下一行的左端行首开始。如果去掉，即使输出打印完成后也不会换行。
printf函数永远不会自动换行，这样我们可以多次调用该函数以分阶段得到一个长的输出行。
> 注意
\n只代表一个字符。

此程序中仍然只包括一个名为main的函数定义。它比前面打印"hello, world" 的程序长一些，但并不复杂。这个程序中引入一些新的概念，包括**注释、声明、变量、算术表达式、循环以及格式化输出**。该程序如下所示：
```C
#include <stadio.h>

/* 当fahr = 0, 20, ……, 300时，分别打印华氏温度与摄氏温度对照表 */

main()
{
    int fahr, celsius;
    int lower, upper, step;
    
    lower = 0;  /* 温度表的下限 */
    upper = 300;  /* 温度表的上限 */
    step = 20;  /* 步长 */
    
    fahr = lower;
    while (fahr <= upper) {
        celsius = 5 * (fahr-32) / 9;
        printf("%d\t%d\n", fahr, celsius);
        fahr = fahr + step;
    }
}
```
其中，类型int表示其后所列变量为**整数**，与之相对应的，float表示所列变量为**浮点数**(即，可以带有小数部分的数)。
在该程序中，绝大部分工作都是在循环体中完成的。循环体中的赋值语句
```C
celsius = 5 * (fahr-32) / 9;
```
用于计算与指定华氏温度对应的摄氏温度值，并将结果赋值给变量celsius。在该语句中，之所以把表达式写成先乘5然后再除以9而不是直接写成5/9，其原因是在C语言及许多其他语言中，整数除法操作将执行**舍位**，结果中的任何小数部分都会被舍弃。出于5和9都是整数，5/9相除后经截取所得的结果为0，，因此这样求得的所有摄氏温度都将为0。
由于输出的数不是右对齐的，所以输出的结果不是很美观。这个问题比较容易解决：如果在printf语句的第一个参数的%d中指明打印宽度，则打印的数字会在打印区域内右对齐。例如：
```C
printf("%3d %6d\n", fahr, celsius);
```
这样，fahr的值占3个数字宽，celsius的值占6个数字宽。
另一个较为严重的问题是，由于我们使用的是整型算术运算，因此经计算得到的摄氏温度值不太精确，例如，与0华氏温度的精确的摄氏温度应该为-17.8摄氏度，而不是-17摄氏度。为了得到更精确的结果，应该用于浮点算术运算代替上面的 整型算术运算。
```C
#include <stadio.h>

/* 当fahr = 0, 20, ……, 300时，分别打印华氏温度与摄氏温度对照表 */

main()
{
    float fahr, celsius;
    int lower, upper, step;
    
    lower = 0;  /* 温度表的下限 */
    upper = 300;  /* 温度表的上限 */
    step = 20;  /* 步长 */
    
    fahr = lower;
    while (fahr <= upper) {
        celsius = 5.0 * (fahr-32) / 9.0;
        printf("%3.0f\t%6.1f\n", fahr, celsius);
        fahr = fahr + step;
    }
}
```
这个程序与前一个程序基本相同，不同的是，它把fahr与celsius声明为float类型，转换公式的表达方式也更自然一些。常数中的小数点表明该常数是一个浮点数，因此，5.0/9.0是两个浮点数相除，结果将不被舍位。
如果某个算术运算符的所有操作数均为整型，则执行整型运算。但是，如果某个算术运算符有一个浮点型操作数和一个整型操作数，则在开始运算之前整型操作数将会被转换为浮点型。例如，在表达式fahr-32中，32在运算过程中将被自动转换为浮点数再参与运算。不过，即使浮点常量取的是整型值，在书写时最好还是为它加上一个显示的小数点，这样可以强调其浮点性质，便于阅读。
## 数据类型
```C
char        // 字符数据类型 1字节 取值范围：-32768 ~ +32767
short       //短整型 2个字节
int         //整型 4个字节
long        // 长整型 4或8个字节
long long // 更长的整型 8个字节
float       // 单精度浮点型 4个字节 取值范围：10^-38 ~ 10^+38
double      // 双精度浮点型 8个字节
```
| 数据类型 | 中文 | 字节 | 取值范围 |
| --- | --- | --- | --- |
| char | 字符数据类型 | 1字节 | -32768 ~ +32767 |
| short | 短整型 | 2字节 |
| int | 整型 | 4字节 |
| long | 长整型 | 4或8字节 |
| long long | 更长的整型 | 8字节 |
| float | 单精度浮点型 | 4字节 | 10^-38 ~ 10^+38 |
| double | 双精度浮点型 | 8字节 |
### 格式说明
```c
%d      // 按照十进制整型数打印
%6d     //  按照十进制整型数打印，至少6个字符宽
%f      //  按照浮点数打印
%6f     // 按照浮点数打印，至少6个字符宽
%.2f        //  按照浮点数打印，小数点后有两位小数
%6.2f       //  按照浮点数打印，至少6个字符宽，小数点后有两位小数
%o      // 表示八进制数
%x      //  表示十六进制数
%c      //  表示字符
%s      //  表示字符串
%%      //  表示百分号(%)本身
```
## 常量
C语言中的常量和变量的定义的形式有所差异。
C语言中的常量分为以下几种：
+ 字面常量
例：3，3.14……
+ const修饰的常变量
例：const int i =1(注：为具有常量属性的变量，其值不可变)
+ #define 定义的标识符常量
例：#define i 5
+ 枚举常量
枚举~一一列举
枚举常量关键字 - enum
> 例如：
```C
# include <stdio.h>

enum Color
{
    red,
    yellow,
    blue
};
main()
{
    enum Color color = blue;  // color是变量可改变值
}
```
## 1.3 for语句
对于某个特定任务我们可以采用多种方法来编写程序。下面的代码也可以实现前面的温度转换程序的功能：
```C
#include <stdio.h>

/* 打印华氏温度-摄氏温度对照表 */
main()
{
    int fahr;
    
    for (fahr = 0; fahr <= 300; fahr = fahr + 20 )
    {
        printf("%3d%6.1f\n", fahr, (5.0/9.0)*(fahr-32));
    }
}
```
for语句是一种循环语句，它是对while语句的推广。
第一部分
```C
fahr = 0
```
是初始化部分，仅在进入循环前执行一次。第二部分
```C
fahr <= 300
```
是控制循环的测试或条件部分。循环控制将对该条件求值，如果结果值为真(true)，则执行循环体。此后将执行第三部分
```C
fahr = fahr + 20
```
以将循环变量fahr增加一个步长，并再次对条件求值。如果计算得到的条件值为假(false)，循环将终止执行。初始化部分(第一部分)、条件部分(第二部分)、与增加步长部分(第三部分)都可以是任何表达式。
for语句比较适合初始化和增加步长都是单条语句并且逻辑相关的情形，因为它将循环控制语句集中放在一起，且比while语句更紧凑。
## 1.4 符号常量
在程序中使用300、20等类似的“幻数”并不是一个好习惯，它们几乎无法向以后阅读该程序的人提供什么信息，而且使程序的修改变得更加困难。处理这种幻数的一种方法是赋予它们有意义的名字。#define指令可以把**符号名（或称为符号常量）**定义为一个特定的字符串：
```C
#define 名字 替换文本
```
在该定义之后，程序中出现的所有在#define中定义的名字(既没有用引号引起来，也不是其他名字的一部分)都将用相应的替换文本替换。其中，名字与普通变量名的形式相同：它们都是以字母打头的字母和数字序列；替换文本可以是任何字符序列，而不仅限于数字。例：
```C
#include <studio.h>

#define  LOWER 0  /* 表的下限 */
#define  UPPER 300  /* 表的上限 */
#define STEP 20  /* 步长值 */

/* 打印华氏温度-摄氏温度对照表 */
main()
{
    int fahr;
    
    for (fahr = LOWER; fahr <= UPPER; fahr = fahr + step)
    {
        printf("%3d%6.1f\n", fahr, (5.0/9.0) * (fahr - 32));
    }
}
```
其中，LOWER、UPPER与STEP都是符号常量，而非变量，因此不需要出现在声明中。符号常量名通常用大写字母拼写，这样可以很容易与小写字母拼写的变量名相区别。
> 注意
#define指令行的末尾没有分号。

## 1.5 字符输入/输出
接下来我们看一组与字符型数据处理有关的程序。读者将会发现，许多程序只不过是这里所讨论的程序原型的扩充版本而已。
标准库提供的输入/输出模型非常简单。无论文本从何处输入，输出到何处，其输入/输出都是按照字符流的方式处理。**文本流**是由多行字符构成的字符序列，而每行字符则由0个或多个字符组成，行末是一个换行符。标准库负责使每个输入/输出流都能够遵守这一模型。使用标准库的C语言程序员不必关心在程序之外这些行是如何表示的。
标准库**提供了一次读/写一个字符的函数**，其中最简单的是getchar和putchar两个函数。每次调用时，**getchar函数**从文本流中**读入**下一个字符，并将其作为结果值返回。也就是说，在执行语句
```C
c = getchar()
```
之后，变量c中将包含输入流中的下一个字符。这种字符通常是通过键盘输入的。
每次调用putchar函数时将打印一个字符。例如，语句
```C
putchar(c)
```
将把整型变量c的内容以字符的形式打印出来，通常是显示在屏幕上。putchar与printf这两个函数可以交替调用，输出的次序与调用的次序一致。

### 1.5.1 文件复制
借助于getchar与putchar函数，可以在不了解其他输入/输出知识的情况下编写出数量惊人的有用的代码。最简单的例子就是把输入一次一个字符地复制到输出，其基本思想如下：
```C
读一个字符
while (该字符不是文件结束指示符)
    输出刚读入的字符
    读下一个字符
```
将上述基本思想转换为C语言程序为：
```c
#include <stdio.h>

/* 将输入复制输出；版本1 */

main()
{
    int c;
    
    c = getchar();
    while (c != EOF) {
        putchar(c);
        c = getchar();
    }
}
```
其中，关系运算符!=表示“不等于”。
字符在键盘、屏幕或其他的任何地方无论以什么形式表现，它在机器内部都是以位模式存储的。char类型专门用于存储这种字符型数据，当然任何整型(int)也可以用于存储字符型数据。因为某些潜在的重要原因，我们在此使用int类型。
这里需要解决如何区分文件中有效数据与输入结束符的问题。C语言采取的解决方法是：在没有输入时，getchar函数将返回一个特殊值，这个特殊值与任何实际字符都不同。这个值称为EOF(end of file，文件结束)。在声明变量c的时候，必须让它大到能够存放getchar函数返回的任何值。之所以不把c声明成char类型，是因为它必须大到除了能存储任何可能的字符外还能存储文件结束符EOF。
EOF定义在头文件<stdio.h>中，是一个整型数。其具体数值是什么并不重要，只要它与任何char类型的值都不相同即可。

### 1.5.2 字符计数
下列程序用于对字符进行计数，它与上面的复制程序类似。
```C
#include <stdio.h>

/* 统计输入的字符数 */

main()
{
    long nc;
    
    nc = 0;
    while (getchar() != EOF) {
        ++nc;
    }
    printf("%1d\n", nc);
}
```
其中，语句
    ++nc;
引入了一个新的运算符++，其功能是执行加1操作。可以用语句nc = nc + 1代替它，但语句++nc更精炼一些，且通常效率也更高。与该运算符相应的是自减运算符--。++与--这两个运算符既可以作为前缀运算符(如++nc)，也可以作为后缀运算符(如nc++)。

### 1.5.3 行计数
标准库保证输入文本流以行序列的形式出现，每一行均以换行符结束。因此，统计行数等价于换行符的个数。
```C
#include <stdio.h>

/* 统计输入中的行数 */

main()
{
    int c, nl;
    
    nl = 0;
    while ((c = getchar()) != EOF) {
        if (c == '\n') {
            ++nl;
        }
        printf("%d\n", nl);
    }
}
```
双等于号==是C语言中表示“等于”关系的运算符。C语言将单等于号=作为赋值运算符，因此使用双等于号==表示相等的逻辑关系，以示区分。
单引号中的字符表示一个整型值，该值等于此字符在机器字符集中对应的数值，我们称之为***字符常量***。但，它只是小的整型数的另一种写法而已。
### 1.5.4 单词计数
此次的应用程序用于统计行数、单词数与字符数。这里对单词的定义比较宽松，它是任何其中不包含空格、制表符或换行符的字符序列。下面这段程序是UNIX系统中的wc程序的骨干部分：
```C
#include <stdio.h>

#define IN 1  /* 在单词内 */
#define OUT 0  /* 在单词外 */

/* 统计输入的行数、单词数与字符数 */
main()
{
    int c, nl, nw, nc, state;
    
    state = OUT;
    nl = nw = nc = 0;
    while ((c = getchar()) != EOF) {
        ++nc;
        if (c == '\n') {
            ++nl;
        }
        if (c == ' ' || c == '\n' || c == '\t') {
            state = OUT;
        else (state == OUT) {
                state = IN;
                ++nw;
            }
        }
    }
    printf("%d %d %d\n", nl, nw, nc);
}
```
下列语句
    nl = nw = nc = 0;
将把其中的3个变量nl、nw与nc都设置为0。
***注意***
在兼有值与赋值两种功能的表达式中，赋值结合次序是由右至左。所以上面这条语句等同于
    nl = (nw = (nc = 0));
    运算符||代表or(逻辑或)，所以下列语句
    if (c == ' ' || c == '\n' || c == '\t')
的意义是“如果c是空格，或c是换行符，或c是制表符”。相应地，运算符&&代表AND(逻辑与)，它仅比||高一个优先级。
这段程序中还包括一个else部分，它指定当if语句中的条件部分为假时所要执行的动作。其一般形式为：
if (表达式) {}
    语句1
}
else {
    语句2
}

## 1.6 数组
所有的输入字符可以分成12类，因此可以用一个数组存放各个数字出现的次数，这样比使用10个独立的变量更方便。下面是给程序的一种版本：
```C
#include <stdio.h>

/* 统计各个数字、空白符及其他字符出现的次数 */
main()
{
    int c, i, nwhite, nother;
    int ndigit[10];
    
    nwhite = nother = 0;
    for (i = 0; i < 10; ++i) {
        ndigit[i] = 0;
    }
    while ((c = getchar()) != EOF) {
        if (c >= '0' && c <= '9') {
            ++ndigit[c-'0'];
        }
        else if (c == ' ' || c == '\n' || c == '\t')
        {
            ++nwhite;
        }
        else
        {
            ++nother;
        }
    }
    printf("digits =");
    for (i = 0; i < 10; ++i)
    {
        printf("%d", ndigit[i]);
        printf(", white space = %d, other = %d\n", nwhite, nother);
    }
}
```
该程序中的声明语句
    int ndigit[10];
将变量ndigit声明为由10个整型数构成的数组。在C语言中，数组的下标总是从**0**开始，因此，该数组的10个元素分别为ndigit[0]……。
数组下标可以是任何整型表达式，包括整型变量以及整型常量。













